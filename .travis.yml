sudo: required

language: php

before_install:
  - docker build -t mpiot/gryc .
  - docker run -d mpiot/gryc
  - docker ps -a
  - docker run mpiot/gryc ./vendor/bin/simple-phpunit
  - docker run mpiot/gryc ./vendor/bin/php-cs-fixer fix --diff --dry-run -v
  - docker run mpiot/gryc ./bin/console lint:yaml app
  - docker run mpiot/gryc ./bin/console lint:twig app/Resources
  - docker run mpiot/gryc ./bin/console security:check --end-point=http://security.sensiolabs.org/check_lock
  - docker run mpiot/gryc composer validate

script:
  - ./vendor/bin/simple-phpunit
  # this checks that the source code follows the Symfony Code Syntax rules
  - ./vendor/bin/php-cs-fixer fix --diff --dry-run -v
  # this checks that the YAML config files contain no syntax errors
  - ./bin/console lint:yaml app
  # this checks that the Twig template files contain no syntax errors
  - ./bin/console lint:twig app/Resources
  # this checks that the application doesn't use dependencies with known security vulnerabilities
  - ./bin/console security:check --end-point=http://security.sensiolabs.org/check_lock
  # this checks that the composer.json and composer.lock files are valid
  - composer validate
